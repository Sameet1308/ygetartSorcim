import warnings
import requests
from mstrio import Connection

# Disable warnings
warnings.filterwarnings("ignore", category=requests.exceptions.InsecureRequestWarning)

# Set up connection parameters
url = 'https://your-microstrategy-server.com/MicroStrategyLibrary/api'
username = 'your-username'
password = 'your-password'

# Set up connection options
options = {
    'ssl_verify': False,
    'login_mode': 16,
    'certificate_path': None,
    'proxies': None,
    'parallelOlapCubeSuperCube': False,
    'timeout': 60
}

# Create a connection object
conn = Connection(url, options=options)

# Log in to the MicroStrategy REST API server
conn.login(username, password)

# Get a list of projects
projects = conn.projects
for project in projects:
    print(project.name)

# Log out and close the connection
conn.logout()
conn.close()