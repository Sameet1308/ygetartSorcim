import requests

# Update these variables according to your setup
base_url = 'http://your-microstrategy-server.com/MicroStrategyLibrary/api'
authToken = 'your_auth_token'
project_id = 'your_project_id'

headers = {
    'X-MSTR-AuthToken': authToken,
    'Accept': 'application/json',
    'Content-Type': 'application/json'
}

# Function to fetch cubes from a specific project
def fetch_cubes(base_url, project_id, headers):
    cubes_endpoint = f"{base_url}/projects/{project_id}/cubes"
    response = requests.get(cubes_endpoint, headers=headers)
    if response.status_code == 200:
        return response.json()
    else:
        print(f"Error fetching cubes: {response.status_code} - {response.text}")
        return []

# Function to list all projects to verify project ID
def list_projects(base_url, headers):
    projects_endpoint = f"{base_url}/projects"
    response = requests.get(projects_endpoint, headers=headers)
    if response.status_code == 200:
        return response.json()
    else:
        print(f"Error fetching projects: {response.status_code} - {response.text}")
        return []

# Main execution
print("Available Projects:")
projects = list_projects(base_url, headers)
for project in projects:
    print(project.get('id'), project.get('name'))

print("\nFetching cubes for Project ID:", project_id)
cubes = fetch_cubes(base_url, project_id, headers)
for cube in cubes:
    print(cube.get('id'), cube.get('name'))