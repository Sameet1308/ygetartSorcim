<!-- Add a custom button in your dossier -->
<button id="exportBtn">Export to PDF</button>

<script>
// Wait until MicroStrategy Library is fully loaded
document.addEventListener("DOMContentLoaded", function () {
    // Add an event listener to your button
    document.getElementById("exportBtn").addEventListener("click", function() {
        // Function to fetch the authentication token and export the dossier
        mstr.library.session.getAuthToken().then(function(authToken) {
            const dossierId = '<Your_Dossier_ID>';
            const projectId = '<Your_Project_ID>';
            const url = `/MicroStrategyLibrary/api/dossiers/${dossierId}/pdf`;

            fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-MSTR-AuthToken': authToken,
                    'X-MSTR-ProjectID': projectId
                }
            })
            .then(response => response.blob())
            .then(blob => {
                const url = window.URL.createObjectURL(new Blob([blob]));
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = 'dossier.pdf';
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
            })
            .catch(error => console.error('Error exporting dossier:', error));
        });
    });
});
</script>