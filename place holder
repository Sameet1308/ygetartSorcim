import requests
import pandas as pd

# Server details
base_url = 'http://your-microstrategy-server.com/MicroStrategyLibrary/api'
authToken = 'your_auth_token'  # This should be set with the actual authToken obtained from login
project_id = 'your_project_id'  # Set this to the ID of the project you want to query

# Headers
headers = {
    'X-MSTR-AuthToken': authToken,
    'Accept': 'application/json'
}

# Fetch cubes for a specific project
def fetch_cubes(project_id):
    cubes_endpoint = f"{base_url}/projects/{project_id}/cubes"
    response = requests.get(cubes_endpoint, headers=headers)
    if response.status_code == 200:
        return response.json()
    else:
        print(f"Failed to retrieve cubes for project {project_id}: {response.status_code}")
        print("Response:", response.text)
        return []

# Process and display cube information
def process_cubes(cubes_data):
    cubes_info = []
    for cube in cubes_data:
        cube_id = cube.get('id')
        cube_name = cube.get('name')
        cube_type = cube.get('type')  # Cube type as per your API documentation (if available)
        cubes_info.append({
            "Cube ID": cube_id,
            "Cube Name": cube_name,
            "Cube Type": cube_type
        })
    return cubes_info

# Main script
cubes_data = fetch_cubes(project_id)
cubes_info = process_cubes(cubes_data)
df_cubes = pd.DataFrame(cubes_info)
print("Cubes DataFrame created successfully:")
print(df_cubes)